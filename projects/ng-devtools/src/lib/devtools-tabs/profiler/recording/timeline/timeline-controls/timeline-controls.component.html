<div class="controls">
  <mat-form-field *ngIf="record">
    <mat-select [value]="visualizationMode" (selectionChange)="this.changeVisualizationMode.emit($event.value)">
      <mat-option [value]="flameGraphMode">
        Flame graph
      </mat-option>
      <mat-option [value]="treeMapMode">
        Tree map
      </mat-option>
      <mat-option [value]="barGraphMode">
        Bar chart
      </mat-option>
    </mat-select>
  </mat-form-field>

  <div
    class="details"
    [class.flame-details]="visualizationMode == flameGraphMode"
    [class.bar-details]="visualizationMode == barGraphMode"
  >
    <label *ngIf="estimatedFrameRate >= 60 && record">
      Time spent: <span class="value">{{ record?.duration | number }} ms</span>
    </label>

    <label [style.color]="frameColor" *ngIf="estimatedFrameRate < 60 && record">
      Time spent: <span class="value">{{ record?.duration | number }} ms</span>
    </label>

    <label [style.color]="frameColor" *ngIf="estimatedFrameRate < 60 && record">
      Frame rate: <span class="value">{{ estimatedFrameRate }} fps</span>
    </label>

    <label *ngIf="record?.source && record">
      Source: <span class="value">{{ record?.source }}</span>
    </label>

    <div *ngIf="!disableTaskInspectOptions && record?.id" (click)="inspectTaskFunction.emit(record!.id)">
      <span class="action-button">
        View Task Callback
      </span>
    </div>

    <div *ngIf="!disableTaskInspectOptions && record?.id" (click)="inspectTaskTarget.emit(record!.id)">
      <span class="action-button">
        View Task Target
      </span>
    </div>

    <mat-checkbox
      *ngIf="visualizationMode == flameGraphMode"
      (change)="this.toggleChangeDetection.emit($event.checked)"
    >
      Show only change detection
    </mat-checkbox>
  </div>

  <button *ngIf="!empty" mat-stroked-button (click)="exportProfile.emit()">Save Profile</button>
</div>
